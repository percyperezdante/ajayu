# A brief introduction

This is a template to build an Oracle Linux 6 (OL6) image using Packer. This template aims to set a minimum base from where you can top up any other artefact you may need.

# Pre-requirements.

It would be good if you have already installed the following:

- Go
  Steps to install from source code in [here](https://golang.org/doc/install/source)

- Packer
  Manual installation from source code in [here](https://github.com/hashicorp/packer/blob/master/.github/CONTRIBUTING.md#setting-up-go-to-work-on-packer)


For testing purposes you may need Vagrant and VirtualBox installed.

# How to build OL6 image

```bash
$ git clone https://github.com/percyperezdante/ajayu.git
$ cd ajayu/oracle_linux_6
$ packer build oracle_linux_6_10.json
```

The last command may take a while during the first run, but the subsequent runs will be faster as all is cached locally at "packer_cache". 

The result of this command will be the file "oracle-linux-6-x86_64_packer-6.10-SNAPSHOT.box" which is the OL6 image you can use further.

# How to clear packer files

To clear all file systems generated by packer, run as:

```bash
$ rm -rf packer_cache    # <-- This clears cache which includes the *.iso image
$ rm -rf oracle-linux-6-x86_64_packer-6.10-SNAPSHOT.box
```

After this you can run build again the image by

```bash
$ packer build oracle_linux_6
```


# How to install custom packages

To install additional customise packages, you can edit the "scripts/install_customise_packages.sh" and add more command lines, shell scripts or others. 

# How to use the built image

There are many option but in here we just suggest one through an example. In this example we add the image to a Vagrant list, and the we start up one VM with this image using vagrant. To verify, you can login to the box and execute an internal inspection if needed.

```bash
$ vagrant box add --name myol6 oracle-linux-6-x86_64_packer-6.10-SNAPSHOT.box
$ vagrant add list
$ mkdir test
$ cd test
$ vagrant init myol6
$ vagrant up
$ vagrant ssh
```

# Test artefacts of the image with Kitchen.
Todo


# References

Here some of most relevant link used to compose this template.

- [An online template for OL6.](https://github.com/developerbmw/packer-oracle-linux-6)
- [Building VM  with packer](https://www.gun.io/blog/building-vagrant-machines-with-packer)
- [A Packer template example](https://github.com/flomotlik/packer-example)
- [Packer terminology](https://packer.io/docs/basics/terminology.html#builders)
- [Creating kickstart files in Oracle Linux 6](https://docs.oracle.com/en/operating-systems/oracle-linux/6/install/ch03s01.html)
- [Creating base box with Vagrant](https://www.vagrantup.com/docs/boxes/base.html)

